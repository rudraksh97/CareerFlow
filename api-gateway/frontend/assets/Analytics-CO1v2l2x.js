import{c as _,r as h,j as e,b as z,m as i,A as g,B as y}from"./index-0B-QrMym.js";import{u as f}from"./useQuery-gFyUPQ7C.js";import{a as N}from"./api-BgONvxhD.js";import{B}from"./building-C-svXhnr.js";import{T as I}from"./trending-up-CiTOepoW.js";import{C as q,D as w}from"./download-BfIeGHGd.js";import{A as V}from"./activity-DO1rZ0Ni.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=_("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=_("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);function K(){return e.jsxs("div",{className:"space-y-8 animate-fade-in",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"h-9 bg-neutral-200 rounded-lg w-32 animate-pulse"}),e.jsx("div",{className:"h-5 bg-neutral-200 rounded w-80 animate-pulse"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((r,n)=>e.jsx("div",{className:"card p-6 animate-pulse",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-neutral-200 rounded w-24 mb-2"}),e.jsx("div",{className:"h-8 bg-neutral-200 rounded w-16"})]}),e.jsx("div",{className:"w-12 h-12 bg-neutral-200 rounded-xl"})]})},n))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card lg:col-span-2 p-6 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-neutral-200 rounded w-48 mb-6"}),e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((r,n)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-neutral-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"h-4 bg-neutral-200 rounded w-24 mb-1"}),e.jsx("div",{className:"h-3 bg-neutral-200 rounded w-32"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"h-5 bg-neutral-200 rounded w-12 mb-1"}),e.jsx("div",{className:"h-3 bg-neutral-200 rounded w-20"})]})]},n))})]}),e.jsxs("div",{className:"card p-6 animate-pulse",children:[e.jsx("div",{className:"h-6 bg-neutral-200 rounded w-48 mb-6"}),e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((r,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-neutral-50 rounded-lg",children:[e.jsx("div",{className:"h-4 bg-neutral-200 rounded w-20"}),e.jsx("div",{className:"h-6 bg-neutral-200 rounded w-12"})]},n))})]})]})]})}function W({title:r,value:n,icon:p}){return e.jsx(i.div,{className:"card-interactive p-6 group",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-neutral-600 mb-1 group-hover:text-neutral-700 transition-colors duration-200",children:r}),e.jsx("p",{className:"text-2xl font-bold text-neutral-900 group-hover:text-neutral-700 transition-colors duration-200",children:n})]}),e.jsx("div",{className:"p-3 rounded-xl bg-neutral-100 border border-neutral-200 transition-all duration-200 group-hover:scale-105",children:e.jsx(p,{className:"h-6 w-6 text-neutral-600"})})]})})}function ee(){var v,b;const[r,n]=h.useState(""),[p,k]=h.useState("json"),[C,u]=h.useState(!1),{data:t,isLoading:S,error:A}=f({queryKey:["analytics"],queryFn:()=>N.get("/analytics/dashboard/").then(s=>s.data),staleTime:2*60*1e3,gcTime:10*60*1e3,retry:2,refetchOnWindowFocus:!1}),{data:l,isLoading:E,error:T}=f({queryKey:["analytics-source"],queryFn:()=>N.get("/analytics/applications/source-effectiveness/").then(s=>s.data),staleTime:5*60*1e3,gcTime:15*60*1e3,retry:2,refetchOnWindowFocus:!1}),O=()=>{if(!t||!l)return;const s={dashboard_overview:{total_applications:t.total_applications,applications_by_status:t.applications_by_status,applications_by_source:t.applications_by_source,success_rate:t.success_rate,recent_applications:t.recent_applications,total_contacts:t.total_contacts,contacts_by_type:t.contacts_by_type,recent_interactions:t.recent_interactions},source_effectiveness:l.source_effectiveness,exported_at:new Date().toISOString()};p==="json"?R(s):L(s),u(!1),n("Analytics data exported successfully!"),setTimeout(()=>n(""),3e3)},R=s=>{const a=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),o=window.URL.createObjectURL(a),c=document.createElement("a");c.href=o,c.download=`pats-analytics-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(o)},L=s=>{const a=[];a.push("Dashboard Overview"),a.push("Metric,Value"),a.push(`Total Applications,${s.dashboard_overview.total_applications}`),a.push(`Success Rate,${s.dashboard_overview.success_rate}%`),a.push(`Recent Applications,${s.dashboard_overview.recent_applications}`),a.push(`Total Contacts,${s.dashboard_overview.total_contacts}`),a.push(""),a.push("Applications by Status"),a.push("Status,Count"),Object.entries(s.dashboard_overview.applications_by_status).forEach(([m,M])=>{a.push(`${m},${M}`)}),a.push(""),a.push("Source Effectiveness"),a.push("Source,Total Applications,Success Rate"),s.source_effectiveness.forEach(m=>{a.push(`${m.source},${m.total_applications},${m.success_rate}%`)});const o=new Blob([a.join(`
`)],{type:"text/csv"}),c=window.URL.createObjectURL(o),d=document.createElement("a");d.href=c,d.download=`pats-analytics-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(c)},$=()=>e.jsx(g,{children:C&&e.jsx(i.div,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>u(!1),children:e.jsxs(i.div,{className:"bg-white rounded-xl p-6 w-full max-w-md mx-4 shadow-2xl border border-neutral-200",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:s=>s.stopPropagation(),children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:"Export Analytics Data"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Format"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["json","csv"].map(s=>e.jsx("button",{onClick:()=>k(s),className:`px-3 py-2 text-sm rounded-lg transition-colors ${p===s?"bg-neutral-900 text-white":"bg-neutral-100 hover:bg-neutral-200 text-neutral-700"}`,children:s.toUpperCase()},s))})]})}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>u(!1),className:"flex-1 px-4 py-2 text-neutral-600 hover:text-neutral-800 font-medium transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:O,className:"flex-1 btn-primary",children:[e.jsx(w,{className:"h-4 w-4 mr-2"}),"Export"]})]})]})})});if(S||E)return e.jsx(K,{});if(A||T)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-red-500 mb-4 flex items-center justify-center gap-2",children:[e.jsx(P,{className:"h-6 w-6"}),e.jsx("span",{className:"font-medium",children:"Failed to load analytics data"})]}),e.jsx("p",{className:"text-neutral-600 mb-4",children:"There was an error loading your analytics. Please try again."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"btn-primary",children:"Retry"})]})});const j=t&&t.total_applications>0,U=[{name:"Total Applications",value:(t==null?void 0:t.total_applications)||0,icon:B},{name:"Interviews",value:((v=t==null?void 0:t.applications_by_status)==null?void 0:v.interview)||0,icon:z},{name:"Offers",value:((b=t==null?void 0:t.applications_by_status)==null?void 0:b.offer)||0,icon:I},{name:"Success Rate",value:`${(t==null?void 0:t.success_rate)||0}%`,icon:J}],F={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},x={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}};return e.jsxs(i.div,{className:"space-y-8",variants:F,initial:"hidden",animate:"visible",children:[e.jsx(g,{children:r&&e.jsxs(i.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"fixed top-4 right-4 z-50 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5"}),r]})}),e.jsx(i.div,{variants:x,className:"relative",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-neutral-900",children:"Analytics"}),e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-neutral-100 rounded-full border border-neutral-200",children:[e.jsx(y,{className:"h-4 w-4 text-neutral-600"}),e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"Insights"})]})]}),e.jsx("p",{className:"text-sm text-neutral-600",children:"Track your application performance and insights"})]}),j&&e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("button",{onClick:()=>u(!0),className:"btn-secondary",children:[e.jsx(w,{className:"h-4 w-4 mr-2"}),"Export"]})})]})}),j?e.jsxs(e.Fragment,{children:[e.jsx(i.div,{variants:x,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:U.map((s,a)=>e.jsx(i.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.5,delay:a*.1},children:e.jsx(W,{title:s.name,value:s.value,icon:s.icon})},s.name))}),e.jsxs(i.div,{variants:x,className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs(i.div,{className:"card p-6 lg:col-span-2",initial:{opacity:0,x:-30},animate:{opacity:1,x:0},transition:{duration:.6},children:[e.jsxs("h2",{className:"text-xl font-semibold text-neutral-900 mb-6 flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5 text-neutral-600"}),"Source Effectiveness"]}),e.jsx("div",{className:"space-y-4",children:(l==null?void 0:l.source_effectiveness.length)===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-neutral-500",children:"No source data available yet"})}):l==null?void 0:l.source_effectiveness.map((s,a)=>e.jsxs(i.div,{className:"flex items-center justify-between p-4 bg-neutral-50 rounded-lg border hover:bg-neutral-100 transition-colors duration-200",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:a*.1},children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-neutral-800 capitalize",children:s.source.replace(/_/g," ")}),e.jsxs("p",{className:"text-sm text-neutral-500",children:[s.total_applications," applications"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-bold text-neutral-900",children:[s.success_rate,"%"]}),e.jsx("p",{className:"text-sm text-neutral-500",children:"success rate"})]})]},s.source))})]}),(t==null?void 0:t.applications_by_status)&&e.jsxs(i.div,{className:"card p-6",initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:{duration:.6},children:[e.jsxs("h2",{className:"text-xl font-semibold text-neutral-900 mb-6 flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5 text-neutral-600"}),"Status Distribution"]}),e.jsx("div",{className:"space-y-4",children:Object.entries(t.applications_by_status).map(([s,a],o)=>e.jsxs(i.div,{className:"flex items-center justify-between p-3 bg-neutral-50 rounded-lg border hover:bg-neutral-100 transition-colors duration-200",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:o*.1},children:[e.jsx("h3",{className:"font-medium text-neutral-700 capitalize",children:s.replace("_"," ")}),e.jsx("p",{className:"text-lg font-bold text-neutral-900",children:a})]},s))})]})]})]}):e.jsxs(i.div,{variants:x,className:"card flex flex-col items-center justify-center py-16 text-center",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5},children:[e.jsx("div",{className:"p-4 rounded-full bg-neutral-100 border-4 border-neutral-50 mb-6",children:e.jsx(y,{className:"h-12 w-12 text-neutral-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-neutral-700 mb-2",children:"No analytics data yet"}),e.jsx("p",{className:"text-neutral-500 max-w-md",children:"Add applications to see analytics and insights here. Track your progress, success rates, and identify the most effective job sources."})]}),e.jsx($,{})]})}export{ee as default};
