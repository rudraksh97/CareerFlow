import{c as V,r as c,j as e,m as a,A as U,F as H,a as te,X as se}from"./index-0B-QrMym.js";import{u as ae}from"./useQuery-gFyUPQ7C.js";import{T as le}from"./TemplateFileManager-Dg7n9nyj.js";import{a as W}from"./api-BgONvxhD.js";import{C as re,D as y}from"./download-BfIeGHGd.js";import{M as O}from"./mail-D00ol1xp.js";import{B as P}from"./building-C-svXhnr.js";import{T as ne}from"./trending-up-CiTOepoW.js";import{C as q,F as ie}from"./trash-2-CzVBZmWj.js";import{S as B}from"./search-DuMWX5kD.js";import{R as ce}from"./rotate-cw-BU4PmOrm.js";import"./useMutation-DdaFRHUm.js";import"./plus-CaDpXQUP.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=V("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=V("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]),me=async()=>{const{data:d}=await W.get("/cover-letters/");return d};function _e(){const[d,C]=c.useState(""),[x,_]=c.useState(""),[h,k]=c.useState(""),[g,S]=c.useState("date_applied"),[u,L]=c.useState("desc"),[J,p]=c.useState(!1),[T,I]=c.useState("csv"),[D,Y]=c.useState("filtered"),[F]=c.useState(!1),[A,M]=c.useState(""),[j,z]=c.useState("letters"),{data:f,isLoading:K,error:Q}=ae({queryKey:["applications","cover-letters"],queryFn:me}),n=(f==null?void 0:f.filter(t=>t.cover_letter_filename))||[],E=c.useMemo(()=>n?[...new Set(n.map(s=>s.company_name))].sort():[],[n]),v=c.useMemo(()=>{if(!n)return[];let t=n.filter(s=>{const l=s.company_name.toLowerCase().includes(d.toLowerCase())||s.job_title.toLowerCase().includes(d.toLowerCase())||s.cover_letter_filename&&s.cover_letter_filename.toLowerCase().includes(d.toLowerCase()),i=!x||s.company_name===x,r=!h||(()=>{const o=new Date(s.date_applied),w=Math.floor((new Date().getTime()-o.getTime())/(1e3*60*60*24));switch(h){case"week":return w<=7;case"month":return w<=30;case"quarter":return w<=90;case"year":return w<=365;default:return!0}})();return l&&i&&r});return t.sort((s,l)=>{let i,r;switch(g){case"date_applied":i=new Date(s.date_applied).getTime(),r=new Date(l.date_applied).getTime();break;case"company_name":i=s.company_name.toLowerCase(),r=l.company_name.toLowerCase();break;case"job_title":i=s.job_title.toLowerCase(),r=l.job_title.toLowerCase();break;case"cover_letter_filename":i=(s.cover_letter_filename||"").toLowerCase(),r=(l.cover_letter_filename||"").toLowerCase();break;default:return 0}return i<r?u==="asc"?-1:1:i>r?u==="asc"?1:-1:0}),t},[n,d,x,h,g,u]),$=()=>{C(""),_(""),k(""),S("date_applied"),L("desc")},X=t=>{window.open(`${W.defaults.baseURL}/applications/${t}/cover-letter`,"_blank")},G=()=>{const t=D==="all"?n:v;T==="csv"?Z(t):ee(t),p(!1),M(`Successfully exported ${t.length} cover letter(s)`),setTimeout(()=>M(""),3e3)},Z=t=>{const l=[["Filename","Company","Job Title","Date Applied"].join(","),...t.map(b=>[`"${b.cover_letter_filename||""}"`,`"${b.company_name}"`,`"${b.job_title}"`,`"${b.date_applied}"`].join(","))].join(`
`),i=new Blob([l],{type:"text/csv"}),r=window.URL.createObjectURL(i),o=document.createElement("a");o.href=r,o.download=`cover-letters-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(r)},ee=t=>{const s=t.map(o=>({filename:o.cover_letter_filename,company:o.company_name,jobTitle:o.job_title,dateApplied:o.date_applied})),l=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),i=window.URL.createObjectURL(l),r=document.createElement("a");r.href=i,r.download=`cover-letters-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(i)},N=({tab:t,label:s,count:l})=>e.jsxs("button",{onClick:()=>z(t),className:`
        px-6 py-3 font-medium text-sm border-b-2 transition-all duration-200
        ${j===t?"border-neutral-900 text-neutral-900 bg-white":"border-transparent text-neutral-600 hover:text-neutral-900 hover:bg-neutral-50"}
      `,children:[s,l!==void 0&&e.jsx("span",{className:`
          ml-2 px-2 py-0.5 text-xs rounded-full font-medium
          ${j===t?"bg-neutral-100 text-neutral-700":"bg-neutral-200 text-neutral-600"}
        `,children:l})]}),R={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},m={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}};return e.jsxs(a.div,{className:"space-y-4",variants:R,initial:"hidden",animate:"visible",children:[e.jsx(U,{children:A&&e.jsxs(a.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"fixed top-4 right-4 z-50 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5"}),A]})}),e.jsx(a.div,{variants:m,className:"relative",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-neutral-900",children:"Cover Letters"}),e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-neutral-100 rounded-full border border-neutral-200",children:[e.jsx(O,{className:"h-4 w-4 text-neutral-600"}),e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"Cover Letter Library"})]})]}),e.jsx("p",{className:"text-sm text-neutral-600",children:"Browse and download your submitted cover letters"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(a.button,{onClick:()=>p(!0),className:"px-4 py-2 bg-white border border-neutral-300 hover:bg-neutral-50 text-neutral-700 rounded-lg font-medium text-sm transition-colors flex items-center gap-2",whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx(y,{className:"h-4 w-4"}),"Export"]})})]})}),e.jsxs(a.div,{variants:m,className:"flex items-end gap-0 border-b border-neutral-200",children:[e.jsx(N,{tab:"templates",label:"Template Letters"}),e.jsx(N,{tab:"letters",label:"Cover Letters",count:n.length}),e.jsx(N,{tab:"stats",label:"Analytics & Stats"})]}),j==="templates"&&e.jsx(a.div,{variants:m,className:"space-y-6",children:e.jsx(le,{fileType:"cover_letter",title:"Cover Letter Templates"})}),j==="stats"&&e.jsx(a.div,{variants:m,className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-neutral-900 mb-4",children:"Cover Letter Overview"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-neutral-600",children:"Total Letters"}),e.jsx("p",{className:"text-2xl font-bold text-neutral-900 mt-1",children:n.length})]}),e.jsx("div",{className:"p-3 rounded-lg border border-blue-200 bg-blue-50 text-blue-600",children:e.jsx(O,{className:"h-6 w-6"})})]})}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-neutral-600",children:"Companies"}),e.jsx("p",{className:"text-2xl font-bold text-neutral-900 mt-1",children:E.length})]}),e.jsx("div",{className:"p-3 rounded-lg border border-green-200 bg-green-50 text-green-600",children:e.jsx(P,{className:"h-6 w-6"})})]})}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-neutral-600",children:"This Month"}),e.jsx("p",{className:"text-2xl font-bold text-neutral-900 mt-1",children:n.filter(t=>{const s=new Date(t.date_applied),l=new Date;return s.getMonth()===l.getMonth()&&s.getFullYear()===l.getFullYear()}).length})]}),e.jsx("div",{className:"p-3 rounded-lg border border-purple-200 bg-purple-50 text-purple-600",children:e.jsx(ne,{className:"h-6 w-6"})})]})}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-neutral-600",children:"Recent"}),e.jsx("p",{className:"text-2xl font-bold text-neutral-900 mt-1",children:n.filter(t=>{const s=new Date(t.date_applied),l=new Date;return l.setDate(l.getDate()-7),s>=l}).length}),e.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"Last 7 days"})]}),e.jsx("div",{className:"p-3 rounded-lg border border-orange-200 bg-orange-50 text-orange-600",children:e.jsx(q,{className:"h-6 w-6"})})]})})]})]})}),j==="letters"&&e.jsx(a.div,{variants:m,className:"space-y-6",children:f&&n.length>0&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-neutral-900",children:"Application Cover Letters"}),e.jsxs("p",{className:"text-sm text-neutral-600",children:["Showing ",v.length," of ",n.length," cover letters"]})]})}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ie,{className:"h-4 w-4 text-neutral-600"}),e.jsx("h4",{className:"font-medium text-neutral-900",children:"Filter & Search"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-neutral-400"}),e.jsx("input",{type:"text",placeholder:"Search cover letters...",value:d,onChange:t=>C(t.target.value),className:"input-field pl-10"})]}),e.jsxs("select",{value:x,onChange:t=>_(t.target.value),className:"input-field",children:[e.jsx("option",{value:"",children:"All Companies"}),E.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{value:h,onChange:t=>k(t.target.value),className:"input-field",children:[e.jsx("option",{value:"",children:"All Time"}),e.jsx("option",{value:"week",children:"Past Week"}),e.jsx("option",{value:"month",children:"Past Month"}),e.jsx("option",{value:"quarter",children:"Past 3 Months"}),e.jsx("option",{value:"year",children:"Past Year"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:g,onChange:t=>S(t.target.value),className:"input-field flex-1",children:[e.jsx("option",{value:"date_applied",children:"Date Applied"}),e.jsx("option",{value:"company_name",children:"Company"}),e.jsx("option",{value:"job_title",children:"Job Title"}),e.jsx("option",{value:"cover_letter_filename",children:"Filename"})]}),e.jsx(a.button,{onClick:()=>L(t=>t==="asc"?"desc":"asc"),className:"btn-secondary px-3",whileHover:{scale:1.02},whileTap:{scale:.98},children:u==="asc"?e.jsx(de,{className:"h-4 w-4"}):e.jsx(oe,{className:"h-4 w-4"})})]})]}),(d||x||h||g!=="date_applied"||u!=="desc")&&e.jsxs("div",{className:"flex items-center gap-2 pt-4 border-t border-neutral-200",children:[e.jsx("span",{className:"text-sm text-neutral-600",children:"Active filters:"}),d&&e.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:["Search: ",d]}),x&&e.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:["Company: ",x]}),h&&e.jsxs("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full",children:["Date: ",h]}),e.jsx(a.button,{onClick:$,className:"text-xs text-neutral-600 hover:text-neutral-900 underline ml-auto",whileHover:{scale:1.02},children:"Clear all"})]})]}),K?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:Array.from({length:8}).map((t,s)=>e.jsxs("div",{className:"card p-6 animate-pulse",children:[e.jsx("div",{className:"h-5 bg-neutral-200 rounded w-3/4 mb-4"}),e.jsx("div",{className:"h-4 bg-neutral-100 rounded w-1/2 mb-3"}),e.jsx("div",{className:"h-4 bg-neutral-100 rounded w-1/2 mb-3"}),e.jsx("div",{className:"h-4 bg-neutral-100 rounded w-1/2 mb-6"}),e.jsx("div",{className:"h-10 bg-neutral-200 rounded-lg w-full"})]},s))}):Q?e.jsxs(a.div,{className:"card p-12 text-center",variants:m,children:[e.jsx("div",{className:"p-4 rounded-full bg-red-100 w-fit mx-auto mb-6",children:e.jsx(H,{className:"h-12 w-12 text-red-500"})}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-900 mb-2",children:"Failed to load cover letters"}),e.jsx("p",{className:"text-neutral-600 mb-6",children:"Please try refreshing the page or contact support if the problem persists."}),e.jsx(a.button,{onClick:()=>window.location.reload(),className:"btn-primary",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Refresh Page"})]}):v.length===0?e.jsxs(a.div,{className:"card p-12 text-center",variants:m,children:[e.jsx("div",{className:"p-4 rounded-full bg-neutral-100 w-fit mx-auto mb-6",children:e.jsx(B,{className:"h-12 w-12 text-neutral-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-900 mb-2",children:"No cover letters found"}),e.jsx("p",{className:"text-neutral-600 mb-6",children:"Try adjusting your filters or search terms to find more cover letters."}),e.jsx(a.button,{onClick:$,className:"btn-secondary",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Clear Filters"})]}):e.jsx(a.div,{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",variants:R,initial:"hidden",animate:"visible",children:v.map((t,s)=>e.jsx(a.div,{className:"card-interactive group",variants:m,transition:{delay:s*.05},whileHover:{y:-4},children:e.jsxs("div",{className:"p-6 h-full flex flex-col",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("div",{className:"p-2 rounded-lg bg-neutral-100 flex-shrink-0",children:e.jsx(H,{className:"h-5 w-5 text-neutral-600"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("h3",{className:"font-semibold text-lg text-neutral-900 truncate group-hover:text-blue-600 transition-colors",title:t.cover_letter_filename,children:t.cover_letter_filename})})]}),e.jsxs("div",{className:"space-y-3 text-sm text-neutral-600",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(te,{className:"h-4 w-4 text-neutral-400 flex-shrink-0"}),e.jsx("span",{className:"truncate",title:t.job_title,children:t.job_title})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{className:"h-4 w-4 text-neutral-400 flex-shrink-0"}),e.jsx("span",{className:"truncate",title:t.company_name,children:t.company_name})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(q,{className:"h-4 w-4 text-neutral-400 flex-shrink-0"}),e.jsx("span",{className:"font-medium text-neutral-700",children:new Date(t.date_applied).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})]})]}),e.jsxs(a.button,{onClick:()=>X(t.id),className:"mt-6 w-full btn-primary",whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Download Letter"]})]})},t.id))})]})}),e.jsx(U,{children:J&&e.jsx(a.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>p(!1),children:e.jsxs(a.div,{initial:{scale:.95},animate:{scale:1},exit:{scale:.95},className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"Export Cover Letters"}),e.jsx(a.button,{onClick:()=>p(!1),className:"text-neutral-400 hover:text-neutral-600",whileHover:{scale:1.1},children:e.jsx(se,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Export Format"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["csv","json"].map(t=>e.jsx(a.button,{onClick:()=>I(t),className:`p-3 rounded-lg border text-center ${T===t?"border-blue-500 bg-blue-50 text-blue-700":"border-neutral-200 hover:border-neutral-300"}`,whileHover:{scale:1.02},whileTap:{scale:.98},children:t.toUpperCase()},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"What to Export"}),e.jsx("div",{className:"space-y-2",children:[{value:"all",label:`All letters (${n.length})`},{value:"filtered",label:`Filtered letters (${v.length})`}].map(({value:t,label:s})=>e.jsx(a.button,{onClick:()=>Y(t),className:`w-full p-3 rounded-lg border text-left ${D===t?"border-blue-500 bg-blue-50 text-blue-700":"border-neutral-200 hover:border-neutral-300"}`,whileHover:{scale:1.01},whileTap:{scale:.99},children:s},t))})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(a.button,{onClick:()=>p(!1),className:"flex-1 btn-secondary",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Cancel"}),e.jsx(a.button,{onClick:G,disabled:F,className:"flex-1 btn-primary",whileHover:{scale:1.02},whileTap:{scale:.98},children:F?e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"h-4 w-4 mr-2 animate-spin"}),"Exporting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Export"]})})]})]})]})})})]})}export{_e as default};
